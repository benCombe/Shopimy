<div class="title">
  <h2>Orders Dashboard</h2>
</div>

<div class="sales-dashboard">
  
  <div class="dashboard-summary">
    <div class="summary-card">
      <h3>Total Sales</h3>
      <p class="summary-value">{{totalSales | currency}}</p>
    </div>
    <div class="summary-card">
      <h3>Orders</h3>
      <p class="summary-value">{{totalOrders}}</p>
    </div>
    <div class="summary-card">
      <h3>Average Order</h3>
      <p class="summary-value">{{averageOrderValue | currency}}</p>
    </div>
    <div class="summary-card">
      <h3>Conversion Rate</h3>
      <p class="summary-value">{{conversionRate}}%</p>
    </div>
  </div>
  
  <div class="charts-section">
    <div class="chart-container">
      <h2>Monthly Sales</h2>
      <div class="bar-chart">
        <div class="chart-legend">
          <span class="legend-label">Monthly Sales ($)</span>
        </div>
        <div class="chart-bars">
          <ng-container *ngFor="let item of monthlySalesData">
            <div class="bar-item">
              <div class="bar-label">{{item.month}}</div>
              <div class="bar-column">
                <div class="bar" [style.height]="getBarHeight(item.amount) + '%'"></div>
              </div>
              <div class="bar-value">{{item.amount | currency:'USD':'symbol':'1.0-0'}}</div>
            </div>
          </ng-container>
        </div>
      </div>
    </div>
    
    <div class="chart-container">
      <h2>Sales by Category</h2>
      <div class="pie-chart-container">
        <div class="pie-chart">
          <ng-container *ngFor="let slice of categorySalesData; let i = index">
            <div class="pie-slice" 
                 [style.--size]="getPieSliceSize(i)" 
                 [style.--color]="slice.color"
                 [style.transform]="'rotate(' + getPieSliceStart(i) + ')'">
            </div>
          </ng-container>
        </div>
        <div class="pie-legend">
          <div *ngFor="let slice of categorySalesData" class="legend-item">
            <span class="color-dot" [style.background-color]="slice.color"></span>
            <span>{{slice.category}}: {{slice.percentage}}%</span>
          </div>
        </div>
      </div>
    </div>
  </div>
  
  <div class="tables-section">
    <div class="table-container">
      <h2>Recent Sales</h2>
      
      <div class="mat-elevation-z8">
        <table mat-table [dataSource]="salesTableDataSource">
          <!-- Order ID Column -->
          <ng-container matColumnDef="orderId">
            <th mat-header-cell *matHeaderCellDef> Order ID </th>
            <td mat-cell *matCellDef="let element"> {{element.orderId}} </td>
          </ng-container>

          <!-- Date Column -->
          <ng-container matColumnDef="date">
            <th mat-header-cell *matHeaderCellDef> Date </th>
            <td mat-cell *matCellDef="let element"> {{element.date}} </td>
          </ng-container>

          <!-- Customer Column -->
          <ng-container matColumnDef="customer">
            <th mat-header-cell *matHeaderCellDef> Customer </th>
            <td mat-cell *matCellDef="let element"> {{element.customer}} </td>
          </ng-container>

          <!-- Items Column -->
          <ng-container matColumnDef="items">
            <th mat-header-cell *matHeaderCellDef> Items </th>
            <td mat-cell *matCellDef="let element"> {{element.items}} </td>
          </ng-container>

          <!-- Amount Column -->
          <ng-container matColumnDef="amount">
            <th mat-header-cell *matHeaderCellDef> Amount </th>
            <td mat-cell *matCellDef="let element"> {{element.amount}} </td>
          </ng-container>

          <!-- Status Column -->
          <ng-container matColumnDef="status">
            <th mat-header-cell *matHeaderCellDef> Status </th>
            <td mat-cell *matCellDef="let element"> 
              <span class="status-badge" [class]="element.status.toLowerCase()">{{element.status}}</span>
            </td>
          </ng-container>

          <tr mat-header-row *matHeaderRowDef="salesDisplayColumns"></tr>
          <tr mat-row *matRowDef="let row; columns: salesDisplayColumns;"></tr>
        </table>

        <mat-paginator [pageSizeOptions]="[5, 10, 20]"
                      showFirstLastButtons
                      aria-label="Select page of sales">
        </mat-paginator>
      </div>
    </div>
    
    <div class="table-container">
      <h2>Top Products</h2>
      
      <div class="mat-elevation-z8">
        <table mat-table [dataSource]="productsTableDataSource">
          <!-- Rank Column -->
          <ng-container matColumnDef="rank">
            <th mat-header-cell *matHeaderCellDef> Rank </th>
            <td mat-cell *matCellDef="let element"> {{element.rank}} </td>
          </ng-container>

          <!-- Product Column -->
          <ng-container matColumnDef="product">
            <th mat-header-cell *matHeaderCellDef> Product </th>
            <td mat-cell *matCellDef="let element"> {{element.product}} </td>
          </ng-container>

          <!-- Category Column -->
          <ng-container matColumnDef="category">
            <th mat-header-cell *matHeaderCellDef> Category </th>
            <td mat-cell *matCellDef="let element"> {{element.category}} </td>
          </ng-container>

          <!-- Units Sold Column -->
          <ng-container matColumnDef="unitsSold">
            <th mat-header-cell *matHeaderCellDef> Units Sold </th>
            <td mat-cell *matCellDef="let element"> {{element.unitsSold}} </td>
          </ng-container>

          <!-- Revenue Column -->
          <ng-container matColumnDef="revenue">
            <th mat-header-cell *matHeaderCellDef> Revenue </th>
            <td mat-cell *matCellDef="let element"> {{element.revenue}} </td>
          </ng-container>

          <tr mat-header-row *matHeaderRowDef="productsDisplayColumns"></tr>
          <tr mat-row *matRowDef="let row; columns: productsDisplayColumns;"></tr>
        </table>

        <mat-paginator [pageSizeOptions]="[5, 10, 20]"
                      showFirstLastButtons
                      aria-label="Select page of top products">
        </mat-paginator>
      </div>
    </div>
  </div>
</div>


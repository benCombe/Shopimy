<div class="container">
<!--   <app-store-nav></app-store-nav> -->
  <div id="main" class="theme3" [style.background-color]="storeDetails?.theme_3" role="main">
    <div class="checkout-container theme2" [style.background-color]="storeDetails?.theme_2" role="form" aria-labelledby="shipping-heading">
      <!-- Remove Step Indicator -->
      <!-- 
      <div class="steps">
        <button [class.theme1]="currentStep === 1" [class.active]="currentStep === 1">1. Shipping</button>
        <button [class.theme1]="currentStep === 2" [class.active]="currentStep === 2">2. Payment</button>
        <button [class.theme1]="currentStep === 3" [class.active]="currentStep === 3">3. Review</button>
      </div> 
      -->

      <!-- Keep only Shipping Details - Remove *ngIf -->
      <h2 id="shipping-heading">Shipping Details</h2>
      <form [formGroup]="shippingForm" novalidate>
        <div class="form-group">
          <label for="firstName" class="fc" [style.color]="storeDetails?.fontColor">First Name</label>
          <input 
            type="text" 
            id="firstName" 
            formControlName="firstName" 
            placeholder="Enter your first name" 
            [class.is-invalid]="shippingForm.get('firstName')?.invalid && shippingForm.get('firstName')?.touched"
            aria-required="true">
          <div class="invalid-feedback" *ngIf="shippingForm.get('firstName')?.invalid && shippingForm.get('firstName')?.touched">
            Please enter your first name
          </div>
        </div>

        <div class="form-group">
          <label for="lastName" class="fc" [style.color]="storeDetails?.fontColor">Last Name</label>
          <input 
            type="text" 
            id="lastName" 
            formControlName="lastName" 
            placeholder="Enter your last name"
            [class.is-invalid]="shippingForm.get('lastName')?.invalid && shippingForm.get('lastName')?.touched"
            aria-required="true">
          <div class="invalid-feedback" *ngIf="shippingForm.get('lastName')?.invalid && shippingForm.get('lastName')?.touched">
            Please enter your last name
          </div>
        </div>

        <div class="form-group">
          <label for="address" class="fc" [style.color]="storeDetails?.fontColor">Address</label>
          <input 
            type="text" 
            id="address" 
            formControlName="address" 
            placeholder="Enter your address"
            [class.is-invalid]="shippingForm.get('address')?.invalid && shippingForm.get('address')?.touched"
            aria-required="true">
          <div class="invalid-feedback" *ngIf="shippingForm.get('address')?.invalid && shippingForm.get('address')?.touched">
            Please enter your address
          </div>
        </div>

        <div class="form-group">
          <label for="city" class="fc" [style.color]="storeDetails?.fontColor">City</label>
          <input 
            type="text" 
            id="city" 
            formControlName="city" 
            placeholder="Enter your city"
            [class.is-invalid]="shippingForm.get('city')?.invalid && shippingForm.get('city')?.touched"
            aria-required="true">
          <div class="invalid-feedback" *ngIf="shippingForm.get('city')?.invalid && shippingForm.get('city')?.touched">
            Please enter your city
          </div>
        </div>

        <div class="form-group">
          <label for="province" class="fc" [style.color]="storeDetails?.fontColor">Province/State</label>
          <input 
            type="text" 
            id="province" 
            formControlName="province" 
            placeholder="Enter your province or state"
            [class.is-invalid]="shippingForm.get('province')?.invalid && shippingForm.get('province')?.touched"
            aria-required="true">
          <div class="invalid-feedback" *ngIf="shippingForm.get('province')?.invalid && shippingForm.get('province')?.touched">
            Please enter your province or state
          </div>
        </div>

        <div class="form-group">
          <label for="country" class="fc" [style.color]="storeDetails?.fontColor">Country</label>
          <input 
            type="text" 
            id="country" 
            formControlName="country" 
            placeholder="Enter your country"
            [class.is-invalid]="shippingForm.get('country')?.invalid && shippingForm.get('country')?.touched"
            aria-required="true">
          <div class="invalid-feedback" *ngIf="shippingForm.get('country')?.invalid && shippingForm.get('country')?.touched">
            Please enter your country
          </div>
        </div>

        <div class="form-group">
          <label for="postalCode" class="fc" [style.color]="storeDetails?.fontColor">Zip/Postal Code</label>
          <input 
            type="text" 
            id="postalCode" 
            formControlName="postalCode" 
            placeholder="Enter your postal code"
            [class.is-invalid]="shippingForm.get('postalCode')?.invalid && shippingForm.get('postalCode')?.touched"
            aria-required="true">
          <div class="invalid-feedback" *ngIf="shippingForm.get('postalCode')?.invalid && shippingForm.get('postalCode')?.touched">
            Please enter your postal code
          </div>
        </div>

        <div class="form-group">
          <label for="email" class="fc" [style.color]="storeDetails?.fontColor">Email</label>
          <input 
            type="email" 
            id="email" 
            formControlName="email" 
            placeholder="Enter your email"
            [class.is-invalid]="shippingForm.get('email')?.invalid && shippingForm.get('email')?.touched"
            aria-required="true">
          <div class="invalid-feedback" *ngIf="shippingForm.get('email')?.invalid && shippingForm.get('email')?.touched">
            Please enter a valid email address
          </div>
        </div>

        <div class="form-group">
          <label for="phone" class="fc" [style.color]="storeDetails?.fontColor">Phone</label>
          <input 
            type="text" 
            id="phone" 
            formControlName="phone" 
            placeholder="Enter your phone number"
            [class.is-invalid]="shippingForm.get('phone')?.invalid && shippingForm.get('phone')?.touched"
            aria-required="true">
          <div class="invalid-feedback" *ngIf="shippingForm.get('phone')?.invalid && shippingForm.get('phone')?.touched">
            Please enter your phone number
          </div>
        </div>
      </form>
      <button 
        id="checkout-btn"
        [style.background-color]="storeDetails?.theme_1"
        [style.color]="storeDetails?.fontColor"
        (click)="proceedToPayment()" 
        [disabled]="!shippingForm.valid || isLoading">
        <span *ngIf="!isLoading">Proceed To Payment</span>
        <span *ngIf="isLoading">
          <i class="fas fa-spinner fa-spin"></i> Processing...
        </span>
      </button>
    </div>

    <!-- Remove Step 2: Payment Details -->
    <!-- 
    <div *ngIf="currentStep === 2">
      <h2>Payment Details</h2>
      <form [formGroup]="paymentForm">
        <div class="form-row">
          <label>Card Number:</label>
          <input type="text" formControlName="cardNumber">
        </div>

        <div class="form-row">
          <label>Expiration:</label>
          <input type="text" formControlName="expiration">
        </div>

        <div class="form-row">
          <label>CVV:</label>
          <input type="text" formControlName="cvv">
        </div>
      </form>
      <button (click)="previousStep()">Back</button>
      <button (click)="nextStep()" [disabled]="!paymentForm.valid">Next</button>
    </div> 
    -->

    <!-- Remove Step 3: Review & Submit -->
    <!-- 
    <div *ngIf="currentStep === 3">
      <h2>Review Your Order</h2>
      <p><strong>Name:</strong> {{ shippingForm.value.firstName }} {{ shippingForm.value.lastName }}</p>
      <p><strong>Address:</strong> {{ shippingForm.value.address }}, {{ shippingForm.value.city }}, {{ shippingForm.value.province }}, {{ shippingForm.value.country }} - {{ shippingForm.value.postalCode }}</p>
      <p><strong>Email:</strong> {{ shippingForm.value.email }}</p>
      <p><strong>Phone:</strong> {{ shippingForm.value.phone }}</p>
      <p><strong>Payment Card:</strong> **** **** **** {{ paymentForm.value.cardNumber?.slice(-4) }}</p>

      <button (click)="previousStep()">Back</button>
      <button (click)="submitOrder()">Submit Order</button>
    </div> 
    -->

    <app-order-summary [storeDetails]="storeDetails"></app-order-summary>
  </div>
</div>


